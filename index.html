<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Pens - Personalized Writing Instruments</title>
    <style>
        /* ... all your existing CSS ... */
    </style>
</head>
<body>
    <!-- Hero Section -->
    <div class="hero-section">
        <h1>âœ’ï¸ Custom Pens</h1>
        <p>Design Your Perfect Personalized Writing Instrument</p>
    </div>

    <!-- Pen Showcase -->
    <div class="pen-showcase">
        <!-- ... your pen cards ... -->
    </div>

    <div class="container">
        <!-- Page 1: Order Details -->
        <div id="page1" class="page active">
            <h2>ğŸ¨ Customize Your Pen</h2>
            <p class="subtitle">Make it uniquely yours!</p>

            <form id="orderForm">
                <!-- ... your form fields ... -->
                <button type="button" onclick="goToPayment()">Confirm Order â†’</button>
            </form>
        </div>

        <!-- Page 2: Payment Method -->
        <div id="page2" class="page">
            <!-- ... payment page content ... -->
            <button type="button" onclick="completeOrder()">Complete Order âœ“</button>
        </div>

        <!-- Page 3: UPI Payment -->
        <div id="page3" class="page">
            <!-- ... UPI page content ... -->
            <button type="button" onclick="confirmUPIPayment()">I Have Completed Payment âœ“</button>
        </div>

        <!-- Page 4: Thank You -->
        <div id="page4" class="page">
            <!-- ... thank you page content ... -->
        </div>
    </div>

    <script>
        let orderData = {};

        function goToPayment() {
            const customName = document.getElementById('customName').value;
            const bodyColor = document.querySelector('input[name="bodyColor"]:checked');
            const gripColor = document.querySelector('input[name="gripColor"]:checked');
            const phone = document.getElementById('phone').value;
            const email = document.getElementById('email').value;
            const address = document.getElementById('address').value;
            
            if (!customName || !bodyColor || !gripColor || !phone || !email || !address) {
                alert('Please fill in all fields and select colors!');
                return;
            }
            
            orderData.customName = customName;
            orderData.bodyColor = bodyColor.value;
            orderData.gripColor = gripColor.value;
            orderData.phone = phone;
            orderData.email = email;
            orderData.address = address;
            
            document.getElementById('summaryName').textContent = orderData.customName;
            document.getElementById('summaryBody').textContent = orderData.bodyColor;
            document.getElementById('summaryGrip').textContent = orderData.gripColor;
            document.getElementById('summaryPhone').textContent = orderData.phone;
            document.getElementById('summaryEmail').textContent = orderData.email;
            document.getElementById('summaryAddress').textContent = orderData.address;
            
            document.getElementById('page1').classList.remove('active');
            document.getElementById('page2').classList.add('active');
            window.scrollTo(0, 0);
        }

        function completeOrder() {
            const paymentMethod = document.querySelector('input[name="payment"]:checked');
            
            if (!paymentMethod) {
                alert('Please select a payment method!');
                return;
            }
            
            orderData.paymentMethod = paymentMethod.value;
            
            if (paymentMethod.value === 'UPI') {
                document.getElementById('page2').classList.remove('active');
                document.getElementById('page3').classList.add('active');
            } else {
                sendOrderEmail();
                document.getElementById('page2').classList.remove('active');
                document.getElementById('page4').classList.add('active');
            }
            window.scrollTo(0, 0);
        }

        function confirmUPIPayment() {
            document.getElementById('page3').classList.remove('active');
            document.getElementById('page4').classList.add('active');
            window.scrollTo(0, 0);
            setTimeout(sendOrderEmail, 500);
        }

        function sendOrderEmail() {
            const orderDetails = {
                customName: orderData.customName,
                bodyColor: orderData.bodyColor,
                gripColor: orderData.gripColor,
                phone: orderData.phone,
                email: orderData.email,
                address: orderData.address,
                paymentMethod: orderData.paymentMethod,
                orderDate: new Date().toLocaleString()
            };
            
            fetch('https://script.google.com/macros/s/AKfycbxzrAgwt46ulQpMWz2xIoLPFfi6oufbhWJ78z2Y62y1BRl6-GnJMWIPvzZvTrM0iO4D/exec', {
                method: 'POST',
                mode: 'no-cors',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(orderDetails)
            })
            .then(() => console.log('Order sent successfully!'))
            .catch((error) => console.error('Error sending order:', error));
        }

        document.querySelectorAll('.payment-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.payment-option').forEach(opt => opt.classList.remove('selected'));
                this.classList.add('selected');
                this.querySelector('input[type="radio"]').checked = true;
            });
        });
    </script>
</body>
</html>
